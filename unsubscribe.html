<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Draggable Video Popup</title>
<style>
/* General CSS */
body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background-color: transparent;
}

#video-popup {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: auto;
    height: 30%;
    aspect-ratio: 16 / 9;
    background-color: transparent;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: none;
    z-index: 1000;
    cursor: grab; /* Change cursor to indicate draggable area */
}

#video-popup.dragging {
    cursor: grabbing; /* Change cursor when dragging */
}

#video-popup video {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

#close-image {
    position: absolute;
    top: 10px;
    right: 10px;
    height: 17px;
    width: 17px;
    cursor: pointer;
    z-index: 1001;
}

.mute-btn {
    position: absolute;
    top: 10px;
    left: 10px;
    background-color: transparent;
    border: none;
    cursor: pointer;
    z-index: 1001;
}

.mute-btn img {
    height: 20px;
    width: 20px;
}

.mute-btn:hover {
    opacity: 0.8;
}

#video-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1002;
    display: block;
}
</style>
</head>
<body>

<div id="video-popup">
    <img id="close-image" src="https://cdn-icons-png.flaticon.com/512/665/665304.png" alt="Close" onclick="closePopup(event)">
    <button id="mute-btn" class="mute-btn" onclick="toggleMute(event)">
        <img id="mute-icon" src="https://cdn-icons-png.flaticon.com/512/5949/5949045.png" alt="Mute">
    </button>
    <div id="video-overlay" onclick="redirectToLink(event)"></div>
    <video id="popup-video" autoplay loop muted playsinline disablePictureInPicture>
        <source src="https://videos.ctfassets.net/69qx72t49ip2/tgOKj5cHC4AH3mxloyAax/4d35baeecd59b9c79e3c5e42d3d78312/1_J-24_KCP_BZero1_Product_Animation03_1080x1920_1.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>
</div>

<script>
// User-Agent Detection
const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
const isAndroid = /Android/i.test(navigator.userAgent);

// Video and Button Elements
const videoPopup = document.getElementById('video-popup');
const video = document.getElementById('popup-video');
const muteIcon = document.getElementById('mute-icon');

// Variables for Draggable Functionality
let isDragging = false;
let startX, startY, initialLeft, initialTop;

// Prevent Buttons from Triggering URL Redirect
function stopPropagation(event) {
    event.stopPropagation();
}

// Close Popup
function closePopup(event) {
    stopPropagation(event);
    videoPopup.remove();
}

// Toggle Mute
function toggleMute(event) {
    stopPropagation(event);
    if (video.muted) {
        video.muted = false;
        muteIcon.src = "https://cdn-icons-png.flaticon.com/512/1705/1705050.png"; // Unmute icon
    } else {
        video.muted = true;
        muteIcon.src = "https://cdn-icons-png.flaticon.com/512/5949/5949045.png"; // Mute icon
    }
}

// Redirect to URL
function redirectToLink(event) {
    window.location.href = "https://luxury.tatacliq.com/search/?searchText=armani%20exchange:relevance:category:LSH1&searchCategory=LSH1";
}

// Make the Video Popup Draggable
videoPopup.addEventListener('mousedown', startDrag);
videoPopup.addEventListener('touchstart', startDrag);

function startDrag(event) {
    isDragging = true;
    const rect = videoPopup.getBoundingClientRect();
    initialLeft = rect.left;
    initialTop = rect.top;

    startX = event.type === 'touchstart' ? event.touches[0].clientX : event.clientX;
    startY = event.type === 'touchstart' ? event.touches[0].clientY : event.clientY;

    videoPopup.classList.add('dragging');

    document.addEventListener('mousemove', drag);
    document.addEventListener('touchmove', drag, { passive: false });
    document.addEventListener('mouseup', endDrag);
    document.addEventListener('touchend', endDrag);
}

function drag(event) {
    if (!isDragging) return;

    const currentX = event.type === 'touchmove' ? event.touches[0].clientX : event.clientX;
    const currentY = event.type === 'touchmove' ? event.touches[0].clientY : event.clientY;

    const deltaX = currentX - startX;
    const deltaY = currentY - startY;

    videoPopup.style.left = `${initialLeft + deltaX}px`;
    videoPopup.style.top = `${initialTop + deltaY}px`;
    videoPopup.style.position = 'absolute';
}

function endDrag() {
    isDragging = false;
    videoPopup.classList.remove('dragging');
    document.removeEventListener('mousemove', drag);
    document.removeEventListener('touchmove', drag);
    document.removeEventListener('mouseup', endDrag);
    document.removeEventListener('touchend', endDrag);
}
</script>

</body>
</html>
